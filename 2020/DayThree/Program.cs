using System;
using System.Collections.Generic;
using System.Linq;

namespace DayThree
{
    class Program
    {
        static void Main(string[] args)
        {
            var rawData = GetRawData();

            var calculator = new TreeEncounterCalculator();

            var numberOfTrees = calculator.CalculateNumberOfTreesInPath(rawData, 3, 1);

            Console.WriteLine(numberOfTrees);
        }

        public static List<string> GetRawData()
        {
            return new List<string>
            {   "..#.......#..##...#...#..#.#...",
                "..##..#..#.....#.........#....#",
                "...#.##..#.#......#.#....#.....",
                "...#.....#......#...#..........",
                ".......#.#..#..#....##....##...",
                ".#......#......#.#..#....#.#...",
                ".#..........#.....###.##..#.#..",
                "....#...##...........#.........",
                "##......#.#...#...#....##.#...#",
                ".....#.....#.#..#....###...#..#",
                ".#....#.........#...#.......#.#",
                ".##......#.#.........#....#.#..",
                "...#........###..#......##....#",
                ".#.....###..........#...#....##",
                "............#......#...#...#..#",
                ".....#.#....#.#.#...........#.#",
                "....#.....#...##.##.....###..#.",
                ".....#.##......#.##.#...#.#.#..",
                "##.....#.##.##....#..##......#.",
                ".....#.....#........#........##",
                "#..#...#.#.#..##....#....##..#.",
                ".#......................##..#..",
                "#.#.#................#.....#...",
                "..#....#.#.#..##..#..#.....##..",
                ".....###..#.............#....##",
                "..#....#.#...#......###..#.....",
                ".......####.....##......#......",
                "..##...#..#...#.#..#......#....",
                "..##..#..#.....#......##.##....",
                ".#......#................#..#.#",
                "...............#....#.......#..",
                "#...........#.#.#........#.#...",
                "...#...#..#.....##..#.##...#.#.",
                ".#.#..#.#.....#...#..##....#.##",
                ".........#...#.#.#....#.......#",
                "............##.#..#.#........#.",
                "#..#..#........#......####.....",
                "..#.#...#...#...#.#...#..#..#..",
                "#....................#.#.#....#",
                ".......#.....#....#....##..#...",
                ".......#.............##.....#..",
                "..##..#.......#..#.........#..#",
                "..##.#........#...#...#..#..#..",
                "..##.#...#................#..#.",
                "..#.....##...##......###.....#.",
                ".....#.....#......#......#.....",
                "....##.#.#....#.....#..........",
                "...#...#.#.....#.###.....#....#",
                "......##....#..##...##.#.......",
                "......................##......#",
                ".##......#...#...#...##.#.##.#.",
                "#.......#...#.....#........#.#.",
                "...............#......#.......#",
                ".#..##...#....#.....###....##..",
                "...#..###...#..#....#.#..#.....",
                ".#...#....#.................#..",
                ".......##....#..##......#.#....",
                "....#.....#.....###...#....#...",
                "..##..#..##........#...........",
                "....#..#.#............#........",
                "####.....##.........#....#.....",
                "........#.....#......#......##.",
                "#..........#........#....#...##",
                "#..#...###.....##.....#.##...#.",
                "......#....##.............#..#.",
                "..#......###...#...#..##.....#.",
                "#.##...#......##.###....#....#.",
                "...............#....#.....###.#",
                "#......#........#.#..##.#.....#",
                "#..............#..##.#....#....",
                ".##....###...#...#.#....#....#.",
                ".......#...#.......#....#..##..",
                "..##.#.....#..#...............#",
                ".##..............#.......#...#.",
                ".....#...#.#..#.........#..#...",
                "........#.#.###......#..#......",
                "..#.......###..#...#...........",
                "............#.#.....#....#...#.",
                "#...#..#......#..#......#......",
                "..##..#......#..#.......#.....#",
                "............#.##.....#.#...#...",
                "....#.#...#.#...#........##....",
                "........##...#...##.....#.#..#.",
                ".#..........#.##...............",
                "###.#..#...###..###..#........#",
                "....#..#............#...#.#.#..",
                ".#....###........#.......#...#.",
                "..........#..#.....#......#....",
                "..##..#.#....#..#.....##....#..",
                "...#...............#......#....",
                "......#.#.#...###.....##.#.....",
                ".#...#.#.#.#....#.....#..#..#.#",
                "..#.....#..##....#......#.#.#..",
                "##.#....#.......#.#.#.......#..",
                ".#.#.#........##.#....#........",
                "...#..#...#.#.........#..#....#",
                "#.#......#.#.#..#.#............",
                "......#.....#.....#.......#..#.",
                ".........#..#.##..#..###....#.#",
                ".......#..........#..#.........",
                "......#.#.##...#.#...##........",
                "...........##..##.##....#......",
                "..#..#...#.###...##.....#..#..#",
                ".#...##.......#.#..........#..#",
                "##......#...........#.#........",
                "..#..#.....##..#.#.......#...#.",
                ".#....#..#.....###.......#...#.",
                "...#..#...#...###.#.###..#.....",
                ".......#...#.##......#.#.#.#...",
                ".#.......#...#...#...##........",
                "...#........#....#..#.#...#.#..",
                "..#............#.....#.#....#..",
                "#.....#.#..#.#....#...#.#.#....",
                "#......#......##.#...........#.",
                ".#..#.........##.#........#....",
                ".#....#.#...#........#......#..",
                "....#..#..#....#..#.#.....#..#.",
                ".##.#.....#..#.#...#.....#..###",
                "#..#......#..##....##..#.......",
                ".......#..##....#.###..........",
                ".#......#..........#........#..",
                ".........#.....#......#.#......",
                ".....#..#.......#...#.#....#...",
                ".#......#...#..#......#.....#.#",
                "#.#.#..#.........#.......##....",
                "...#..#.....#.#..#......#...#..",
                ".##...#...#.#....#.....#.#...#.",
                "..#......##......#....#.#..#...",
                "....#.#.....#..#...........#...",
                ".#........#....#....#...#......",
                "..#.#.....#.......#.#.#.##..##.",
                "...#..#.##.......#...#.........",
                "....##.#.#..#.#..#.#.#..#.#.#.#",
                "......#.......#.....#...##.#...",
                "..#.##.....#....#...#...##.##.#",
                "..##.........##.........#..#...",
                ".....###......####..#.#...#....",
                "...#....#....##.............#.#",
                ".#.........#.......##..#.#.....",
                "...#..#........#...............",
                "........#........##......#.#...",
                "##...#......#.....#.##........#",
                ".............#.#........#......",
                ".......##.........#.......#....",
                "....#.......#......#..###....#.",
                ".#.##........#.....#......#....",
                "#...........##...#..##.........",
                ".....#.#........#........##...#",
                "#.........#..##.....#...#....#.",
                ".........#...####..#....###....",
                "###.#..##.......#....#....#.##.",
                "...........#.....#.#...#..#....",
                ".##......###.#.#.#....#........",
                "....#..................#.###.#.",
                "#..##...#......#...#......###..",
                ".#.....#..##......#.#.#.#......",
                "..##...#..#.......##.#.......#.",
                "...#..#..##..##..##.#..####....",
                "......#..#..............#.#####",
                "....#....#..#...#...#.#........",
                ".###...#.......#..#........#...",
                "........#.#......##...#........",
                ".#..#.......##.......#.....##..",
                "...##..........##...........#..",
                "......................#..#.#.#.",
                "#..#.....#......#.....#....#.##",
                "..#......#.....#....#...#.##.#.",
                "............#...#...#......#.##",
                "........##.......#......##.....",
                "..#.##.....#....#..##...#......",
                "........#.#...##.#..#...#....#.",
                "...##............##.....#..#...",
                "...###.##....#....#.#.#.#..#...",
                "............#..#....#..#.....##",
                "...#......##.......#......##..#",
                ".......#......#........#.....#.",
                ".#....#.##..........#..........",
                "..###.........#..#...##.....#..",
                "##....##..#.......###....#.#.#.",
                "#.......#.#.##.................",
                "..#..........#................#",
                "....#.#....#...###...#......#..",
                ".#..........#..#..##.....#...##",
                ".#.....###....#.#...#.#........",
                ".........##.........#..#.#.....",
                ".#.....##....#......##.#....#..",
                "###..#...#..#.........#......#.",
                "..##.....#....#............#...",
                ".....##.##....#.....#..#..#....",
                ".......###...#..........#......",
                "...#........#....#.##.#........",
                "........###....##........##.#..",
                "....#....#........#.....##.....",
                ".#........#.#........#...#..#..",
                "#..#..#......#....##.#..###....",
                "...........#...#...#....#.#...#",
                ".#..#.....#.##..#......##......",
                "..#.#...............##..##.###.",
                "...#.#...#............##.#..#..",
                ".#.#....#....#................#",
                "...#..#.#.##.#.#....#......#...",
                ".........#..#.......##.##.#....",
                "..............#..##.#.....#....",
                "......#.........#...#...##.#..#",
                "....##.....#.#...#.#.####.#....",
                "#..#.#....#.##.......#....#....",
                "...##....#...................##",
                "##.#.......#....#.#.........#.#",
                ".##.#..###...#.#.........#.....",
                "...#.#.#..#...#...#.##....#..#.",
                "....#.....###...#....##........",
                ".............#....#....#....#..",
                "#...#.....#.#...#.#............",
                "#.#....#...........##.......#..",
                "..#..#.........#....###.......#",
                "....###..................##...#",
                ".#........#.....##...#......#..",
                "#..#......#..#.....#.##..#...#.",
                "....#........#.##.#......#.....",
                "#.#...#...............####...##",
                "#.#.....##..#.####.............",
                "##...##..#.##........#.#...#...",
                "...#...........#............#..",
                "...#..#..#........##...........",
                "..#.##..#.#...#...#..#......#..",
                ".....##......#...##.....##.....",
                ".......##.....##....#..........",
                "..........#.#...............#.#",
                "#.#..........#..#..##..#...#..#",
                ".#.#..#.###................#...",
                "#...#...#....#...#....#.##.##..",
                ".#................###.....##...",
                ".....##.#.....##.#.....#.....##",
                ".......#.......#......#.#......",
                "..#....#......#.....#.....#..#.",
                "#......#..##..####.....#.#..#..",
                ".......#...###..#...#.....#....",
                "#.#.#......#.............#..###",
                ".#.#.......#..#.#..#..#...#.#..",
                "..#.#......#......#.#....#.....",
                "..#..###..#.#.....#....#.......",
                "..........#........#......#..#.",
                "##..........##....##..###.##...",
                "...#....#.......#..##.......#..",
                "##...#............##...#.#.#.#.",
                "...........#...#.#....#.....##.",
                ".#................#.......#...#",
                "....##.#..#.#.........###.###.#",
                "#..#...###..#...#......#..##...",
                "..##........#.#..##.#..........",
                "...#..#...#...............#.#..",
                "##.##....#...#........#...#....",
                "#..#......#.##.................",
                ".....#..##.##.......#..........",
                "...#.....#........#......#.....",
                ".....#..#......#.....##...#....",
                "#......#...###....#....###.....",
                "................###..#..#..#.##",
                "......#.......#..........#.#..#",
                "###..#..#.##.............#.#...",
                "....##.#.......#...#..##.......",
                "..#.....##..#..#..#.#..........",
                ".#.......#.#..#........##......",
                "..............#.........#......",
                "..#........##....#.#.#......##.",
                ".#.#.........#.#...#.#.........",
                "..........#..#.##.#....#...#.#.",
                "............##....#.....###...#",
                "#....#..#...#.#...#.....#....#.",
                ".#...##.....#......#..#........",
                ".#..#...###.#..##........#...#.",
                "#..#...##.####.......#.....#...",
                "#.##..#...#......#.#.......#.#.",
                "#.#.....##...#.#...............",
                "#...........##.##.#.........#..",
                "...#...........#.#.#.#....#..#.",
                "..#......#.#.#....##..#.#.....#",
                ".........#.#.##...##...#.#.#...",
                "...........#..#.####.#..#.#.###",
                "#........#.#......#..#...#.....",
                "...#....#......##...#.#........",
                "......#.#....#.##....#....#..##",
                ".......###......#.#.....#......",
                "#..........##..................",
                ".###.......##..#..##...##......",
                "##.#..............#....#....##.",
                "#....#.....#.##.....#..#....#.#",
                ".......#.......#..#..#..##..#..",
                "......#...........#..##....#...",
                ".....#.......#..#......#..#..##",
                ".##...#......#........#....#...",
                ".....#..#....#...............##",
                "..#.....#....#..#.##....#.#....",
                "#.#......####...#..#.........#.",
                "#.#........#..#........#...#...",
                "..#..............#.......###.#.",
                "...#.#....##.#......#........#.",
                "....###.......##.#.....##.....#",
                ".........#......#.#.......##.##",
                ".......#.#....#.#...#...#....#.",
                "....#....#....#.#.......##.....",
                "#...#.....#..#.....#...........",
                "#...#..#...#.#..#.............#",
                "........###..#........#........",
                ".............#....#..###..#.#.#",
                "#...............#..#.#.........",
                "##.....###..#......#...#....#..",
                ".#...................##.#.##...",
                "#..#........#.#...#..#...#.....",
                "................#.#.........#..",
                "#.....##.#.#...#..#.........##.",
                "...#.....#....#..####.#........",
                "....#.#...........#............",
                ".....#........##..........#....",
                "..#.......#.#.#.####..#......#.",
                "#.......#...##.#.#..#.#.#......",
                "##........#.#...###............",
                "..##........#........#...#.#.#.",
                "#.#..#.#.......#....#........#.",
                "..............#....#.........#.",
                "#....#.#........#.............#",
                "..##...#..........#........#...",
                "..#..#..#....#....#............"
            };
        }
    }

    class TreeEncounterCalculator
    {
        private const char Tree = '#';
        private const char OpenSpace = '.';

        public int CalculateNumberOfTreesInPath(List<string> rawData, int xMovement, int yMovement)
        {
            var fullData = ExtendRawData(rawData, xMovement);

            var numberOfTrees = CountTreesInPath(fullData, xMovement, yMovement);
            
            return numberOfTrees;
        }

        private int CountTreesInPath(List<string> fullData, int xMovement, int yMovement)
        {
            var numberOfTrees = 0;
            var xCoordinate = 0;
            var yCoordinate = 0;

            while (yCoordinate < fullData.Count)
            {
                var row = fullData[yCoordinate];

                var charsInRow = row.ToCharArray();
                
                var targetLocation = charsInRow[xCoordinate];

                if (IsTree(targetLocation))
                {
                    numberOfTrees++;
                }

                xCoordinate += xMovement;
                yCoordinate += yMovement;
            }

            return numberOfTrees;
        }

        private bool IsTree(Char location)
        {
            return location == Tree;
        }

        private List<string> ExtendRawData(List<string> rawData, int xMovement)
        {
            var numberOfRows = rawData.Count;
            
            var horizontalLengthRequired = numberOfRows * xMovement;

            var numberOfColumns = (decimal)rawData.First().Length;

            var numberOfConcatinationsRequired = Decimal.ToInt32(Math.Ceiling(horizontalLengthRequired / numberOfColumns));

            var extendedData = new List<string>();

            foreach (var row in rawData)
            {
                var extendedRow = string.Empty;

                for (int i = 0; i < numberOfConcatinationsRequired; i++)
                {
                    extendedRow += row;
                }

                extendedData.Add(extendedRow);
            }

            return extendedData;
        }
    }
}
